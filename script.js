const bsadMapping={2079:{1:[2022,3,14],2:[2022,3,14],3:[2022,4,15],4:[2022,5,15],5:[2022,6,17],6:[2022,7,17],7:[2022,8,17],8:[2022,9,18],9:[2022,10,17],10:[2022,11,16],11:[2023,0,15],12:[2023,1,13]},2080:{1:[2023,2,15],2:[2023,3,14],3:[2023,4,15],4:[2023,5,16],5:[2023,6,17],6:[2023,7,18],7:[2023,8,18],8:[2023,9,18],9:[2023,10,17],10:[2023,11,17],11:[2024,0,15],12:[2024,1,13]},2081:{1:[2024,2,14],2:[2024,3,13],3:[2024,4,14],4:[2024,5,15],5:[2024,6,16],6:[2024,7,17],7:[2024,8,17],8:[2024,9,17],9:[2024,10,16],10:[2024,11,16],11:[2025,0,14],12:[2025,1,13]},2082:{1:[2025,2,14],2:[2025,3,14],3:[2025,4,15],4:[2025,5,15],5:[2025,6,17],6:[2025,7,17],7:[2025,8,17],8:[2025,9,18],9:[2025,10,17],10:[2025,11,16],11:[2026,0,15],12:[2026,1,13]},2083:{1:[2026,2,15],2:[2026,3,14],3:[2026,4,15],4:[2026,5,15],5:[2026,6,17],6:[2026,7,17],7:[2026,8,17],8:[2026,9,18],9:[2026,10,17],10:[2026,11,16],11:[2027,0,15],12:[2027,1,13]},2084:{1:[2027,2,15],2:[2027,3,14],3:[2027,4,15],4:[2027,5,15],5:[2027,6,17],6:[2027,7,17],7:[2027,8,17],8:[2027,9,17],9:[2027,10,16],10:[2027,11,16],11:[2028,0,14],12:[2028,1,13]},2085:{1:[2028,2,14],2:[2028,3,13],3:[2028,4,14],4:[2028,5,15],5:[2028,6,16],6:[2028,7,17],7:[2028,8,16],8:[2028,9,17],9:[2028,10,16],10:[2028,11,16],11:[2029,0,14],12:[2029,1,13]},2086:{1:[2029,2,15],2:[2029,3,14],3:[2029,4,14],4:[2029,5,15],5:[2029,6,16],6:[2029,7,17],7:[2029,8,17],8:[2029,9,17],9:[2029,10,16],10:[2029,11,16],11:[2030,0,14],12:[2030,1,13]}},bsMonthNames=["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Poush","Magh","Falgun","Chaitra"];function setDefaultDates(){let e=new Date;document.getElementById("ad-date").valueAsDate=e;let t=adToBS(e);t&&(document.getElementById("bs-year").value=t.bs_year,document.getElementById("bs-month").value=t.bs_month,document.getElementById("bs-day").value=t.bs_day)}function updateTodayInfo(){let e=new Date,t=e.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),a=adToBS(e),n=`Today: ${t}`;a&&(n+=` / BS ${a.bs_day} ${bsMonthNames[a.bs_month-1]} ${a.bs_year}`),document.getElementById("today-info").innerText=n}function getADDateFromBSData(e,t,a){if(!bsadMapping[e]||!bsadMapping[e][t])return null;let[n,_,l]=bsadMapping[e][t],s=new Date(n,_,l);return s.setDate(s.getDate()+a-1),s}function getDaysInBSMonth(e,t){if(!bsadMapping[t]||!bsadMapping[t][e])return null;let a=e%12+1,n=e<12?t:t+1;if(bsadMapping[n]&&bsadMapping[n][a]){let _=getADDateFromBSData(t,e,1),l=getADDateFromBSData(n,a,1);if(_&&l)return Math.floor((l-_)/864e5)}return 30}function bsToAD(e,t,a){return getADDateFromBSData(e,t,a)}function adToBS(e){for(let t in bsadMapping)for(let a in bsadMapping[t]){let[n,_,l]=bsadMapping[t][a],s=new Date(n,_,l),$=parseInt(a)%12+1,d=12>parseInt(a)?parseInt(t):parseInt(t)+1,r;if(bsadMapping[d]&&bsadMapping[d][$]){let[o,i,g]=bsadMapping[d][$];(r=new Date(o,i,g)).setDate(r.getDate()-1)}else(r=new Date(s)).setDate(r.getDate()+29);if(e>=s&&e<=r){let y=e-s,b=Math.floor(y/864e5)+1;return{bs_day:b,bs_month:parseInt(a),bs_year:parseInt(t)}}}return null}function getADDateRangeForBSMonth(e,t){if(!bsadMapping[e]||!bsadMapping[e][t])return{start:null,end:null};let[a,n,_]=bsadMapping[e][t],l=new Date(a,n,_),s=t%12+1,$=t<12?e:e+1,d;if(bsadMapping[$]&&bsadMapping[$][s]){let[r,o,i]=bsadMapping[$][s];(d=new Date(r,o,i)).setDate(d.getDate()-1)}else(d=new Date(l)).setDate(d.getDate()+29);return{start:l,end:d}}function convertBStoAD(){let e=parseInt(document.getElementById("bs-year").value),t=parseInt(document.getElementById("bs-month").value),a=parseInt(document.getElementById("bs-day").value),n=getDaysInBSMonth(t,e);if(a<1||a>n){document.getElementById("bs-to-ad-result").innerText=`Invalid day. ${bsMonthNames[t-1]} ${e} has ${n} days.`,document.getElementById("bs-to-ad-result").style.display="block";return}let _=bsToAD(e,t,a);if(_){let l=_.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",weekday:"long"});document.getElementById("bs-to-ad-result").innerText=`BS ${a} ${bsMonthNames[t-1]} ${e} = ${l}`,document.getElementById("bs-to-ad-result").style.display="block"}else document.getElementById("bs-to-ad-result").innerText="Conversion failed. Please check your input.",document.getElementById("bs-to-ad-result").style.display="block"}function convertADtoBS(){let e=document.getElementById("ad-date").value;if(!e){document.getElementById("ad-to-bs-result").innerText="Please select a date.",document.getElementById("ad-to-bs-result").style.display="block";return}let t=new Date(e),a=adToBS(t);if(a){let n=`BS ${a.bs_day} ${bsMonthNames[a.bs_month-1]} ${a.bs_year}`;document.getElementById("ad-to-bs-result").innerText=`${t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",weekday:"long"})} = ${n}`,document.getElementById("ad-to-bs-result").style.display="block"}else document.getElementById("ad-to-bs-result").innerText="Conversion failed. Date may be out of supported range.",document.getElementById("ad-to-bs-result").style.display="block"}function renderBSCalendar(){let e=new Date,t=adToBS(e);if(!t)return;let a=t.bs_year,n=t.bs_month;document.getElementById("calendar-title").innerText=`BS Calendar - ${bsMonthNames[n-1]} ${a}`;let _=getADDateRangeForBSMonth(a,n);if(!_.start||!_.end)return;let l=_.start,s=getDaysInBSMonth(n,a),$=l.getDay(),d="",r=1;for(let o=0;o<6&&!(r>s);o++){d+="<tr>";for(let i=0;i<7;i++)if(0===o&&i<$||r>s)d+='<td class="other-month"></td>';else{let g=r===t.bs_day,y=g?"current-day":"",b=bsToAD(a,n,r),u=b?b.getDate()+"/"+(b.getMonth()+1):"";d+=`<td class="${y}">
                    <div>${r}</div>
                    <div style="font-size: 0.8em; color: #666;">${u}</div>
                </td>`,r++}d+="</tr>"}document.getElementById("calendar-body").innerHTML=d}function updateCalendar(e,t){document.getElementById("calendar-title").innerText=`BS Calendar - ${bsMonthNames[t-1]} ${e}`;let a=getADDateRangeForBSMonth(e,t);if(!a.start||!a.end)return;let n=a.start,_=getDaysInBSMonth(t,e),l=n.getDay(),s="",$=1,d=new Date,r=adToBS(d),o=r&&r.bs_month===t&&r.bs_year===e;for(let i=0;i<6&&!($>_);i++){s+="<tr>";for(let g=0;g<7;g++)if(0===i&&g<l||$>_)s+='<td class="other-month"></td>';else{let y=o&&$===r.bs_day,b=y?"current-day":"",u=bsToAD(e,t,$),m=u?u.getDate()+"/"+(u.getMonth()+1):"";s+=`<td class="${b}">
                    <div>${$}</div>
                    <div style="font-size: 0.8em; color: #666;">${m}</div>
                </td>`,$++}s+="</tr>"}document.getElementById("calendar-body").innerHTML=s}window.onload=function(){setDefaultDates(),updateTodayInfo(),renderBSCalendar()},document.getElementById("bs-month").addEventListener("change",function(){let e=parseInt(document.getElementById("bs-year").value),t=parseInt(this.value);updateCalendar(e,t)}),document.getElementById("bs-year").addEventListener("change",function(){let e=parseInt(this.value),t=parseInt(document.getElementById("bs-month").value);updateCalendar(e,t)});