const bsadMapping={2e3:[14,14,15,16,17,17,17,16,16,14,13,13],2001:[13,14,14,16,16,16,17,16,15,14,12,14],2002:[13,14,14,16,17,17,17,16,15,14,12,14],2003:[13,14,15,16,17,17,17,16,16,14,12,14],2004:[14,14,15,16,17,17,17,16,16,14,13,13],2005:[13,14,14,16,16,16,17,16,15,14,12,14],2006:[13,14,14,16,17,17,17,16,15,14,12,14],2007:[13,14,15,16,17,17,17,16,16,14,12,14],2008:[14,15,15,16,17,17,18,16,16,15,13,13],2009:[13,14,14,16,16,16,17,16,15,14,12,14],2010:[13,14,14,16,17,17,17,16,15,14,12,14],2011:[13,14,15,16,17,17,17,16,16,14,12,14],2012:[14,15,15,16,17,17,18,16,16,15,13,14],2013:[13,14,14,16,16,16,17,16,15,14,12,14],2014:[13,14,14,16,17,17,17,16,15,14,12,14],2015:[13,14,15,16,17,17,17,16,16,14,12,14],2016:[14,15,15,16,17,17,18,16,16,15,13,14],2017:[13,14,14,16,16,16,17,16,15,14,12,14],2018:[13,14,15,16,17,17,17,16,15,14,12,14],2019:[13,14,15,16,17,17,17,16,16,14,13,14],2020:[14,15,15,16,17,17,18,17,16,15,13,14],2021:[13,14,14,16,16,16,17,16,15,14,12,14],2022:[13,14,15,16,17,17,17,16,16,14,12,14],2023:[13,14,15,16,17,17,17,16,16,14,13,14],2024:[14,15,15,16,17,17,18,17,16,15,13,14],2025:[13,14,14,16,16,16,17,16,15,14,12,14],2026:[13,14,15,16,17,17,17,16,16,14,12,14],2027:[14,14,15,16,17,17,17,16,16,14,13,14],2028:[14,15,15,17,17,17,18,17,16,15,13,14],2029:[13,14,14,16,16,17,17,16,15,14,12,14],2030:[13,14,15,16,17,17,17,16,16,14,12,14],2031:[14,14,15,16,17,17,17,16,16,14,13,14],2032:[14,15,15,17,17,17,18,17,16,15,13,14],2033:[13,14,14,16,17,17,17,16,15,14,12,14],2034:[13,14,15,16,17,17,17,16,16,14,12,14],2035:[14,14,15,16,17,17,18,16,16,15,13,14],2036:[14,15,15,17,17,17,18,17,16,15,13,14],2037:[13,14,14,16,17,17,17,16,15,14,12,14],2038:[13,14,15,16,17,17,17,16,16,14,12,14],2039:[14,15,15,16,17,17,18,16,16,15,13,15],2040:[14,15,15,17,17,17,18,17,16,15,13,14],2041:[13,14,14,16,17,17,17,16,15,14,12,14],2042:[13,14,15,16,17,17,17,16,16,14,12,14],2043:[14,15,15,16,17,17,18,16,16,15,13,15],2044:[14,15,15,17,17,17,18,17,16,15,13,14],2045:[13,14,15,16,17,17,17,16,15,14,12,14],2046:[13,14,15,16,17,17,17,16,16,14,12,14],2047:[14,15,15,16,17,17,18,17,16,15,13,15],2048:[14,15,15,17,17,17,18,17,16,15,13,14],2049:[13,14,15,16,17,17,17,16,16,14,12,14],2050:[13,14,15,16,17,17,17,16,16,14,13,14],2051:[14,15,15,16,17,17,18,17,16,15,13,15],2052:[14,15,15,17,17,17,18,17,16,15,13,14],2053:[13,14,15,16,17,17,17,16,16,14,12,14],2054:[13,14,15,16,17,17,17,16,16,14,13,14],2055:[14,15,15,17,17,17,18,17,16,15,13,15],2056:[14,15,15,17,17,18,18,17,16,15,13,14],2057:[13,14,15,16,17,17,17,16,16,14,12,14],2058:[14,14,15,16,17,17,17,16,16,14,13,14],2059:[14,15,15,17,17,17,18,17,16,15,13,15],2060:[14,15,15,17,18,18,18,17,16,15,13,14],2061:[13,14,15,16,17,17,17,16,16,14,12,14],2062:[14,15,15,16,17,17,18,16,16,14,13,14],2063:[14,15,15,17,17,17,18,17,16,15,13,15],2064:[14,15,15,17,18,18,18,17,16,15,13,14],2065:[13,14,15,16,17,17,17,16,16,14,12,14],2066:[14,15,15,16,17,17,18,16,16,15,13,14],2067:[14,15,15,17,17,17,18,17,16,15,13,15],2068:[14,15,15,17,18,18,18,17,16,15,13,14],2069:[13,14,15,16,17,17,17,16,16,14,12,14],2070:[14,15,15,16,17,17,18,16,16,15,13,15],2071:[14,15,15,17,17,17,18,17,16,15,13,15],2072:[14,15,16,17,18,18,18,17,16,15,13,14],2073:[13,14,15,16,17,17,17,16,16,14,12,14],2074:[14,15,15,16,17,17,18,17,16,15,13,15],2075:[14,15,15,17,17,17,18,17,16,15,13,15],2076:[14,15,16,17,18,18,18,17,17,15,13,14],2077:[13,14,15,16,17,17,17,16,16,14,13,14],2078:[14,15,15,16,17,17,18,17,16,15,13,15],2079:[14,15,15,17,17,17,18,17,16,15,13,15],2080:[14,15,16,17,18,18,18,17,17,15,13,14],2081:[13,14,15,16,17,17,17,16,16,14,13,14],2082:[14,15,15,17,17,17,18,17,16,15,13,15],2083:[14,15,15,17,17,17,18,17,16,15,13,15],2084:[14,15,15,17,17,17,17,16,16,14,13,14],2085:[13,14,15,16,17,16,17,16,16,14,13,15],2086:[14,14,15,16,17,17,17,16,16,14,13,15],2087:[14,15,15,17,17,17,18,17,17,16,15,17],2088:[16,16,16,18,19,18,19,18,18,16,15,16]},bsMonthNames=["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Poush","Magh","Falgun","Chaitra"];function setDefaultDates(){let _=new Date;document.getElementById("ad-date").valueAsDate=_;let e=adToBS(_);e&&(document.getElementById("bs-year").value=e.bs_year,document.getElementById("bs-month").value=e.bs_month,document.getElementById("bs-day").value=e.bs_day)}function updateTodayInfo(){let _=new Date,e=_.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),t=adToBS(_),a=`Today: ${e}`;t&&(a+=` / BS ${t.bs_day} ${bsMonthNames[t.bs_month-1]} ${t.bs_year}`),document.getElementById("today-info").innerText=a}function getADDateFromBSData(_,e,t){if(!bsadMapping[_]||e<1||e>12)return null;let a=_-57,n=bsadMapping[_][e-1],l=(e+2)%12,s=new Date(l>=3?a:a+1,l,n);return s.setDate(s.getDate()+t-1),s}function getDaysInBSMonth(_,e){if(!bsadMapping[e]||_<1||_>12)return null;let t=_%12+1,a=_<12?e:e+1;if(bsadMapping[a]&&bsadMapping[a][t-1]){let n=getADDateFromBSData(e,_,1),l=getADDateFromBSData(a,t,1);if(n&&l)return Math.floor((l-n)/864e5)}return 30}function bsToAD(_,e,t){return getADDateFromBSData(_,e,t)}function adToBS(_){for(let e in bsadMapping)for(let t=1;t<=12;t++){let a=getADDateFromBSData(e,t,1),n=t%12+1,l=t<12?parseInt(e):parseInt(e)+1,s;if(bsadMapping[l]&&bsadMapping[l][n-1]?(s=getADDateFromBSData(l,n,1)).setDate(s.getDate()-1):(s=new Date(a)).setDate(s.getDate()+29),_>=a&&_<=s){let d=_-a,r=Math.floor(d/864e5)+1;return{bs_day:r,bs_month:t,bs_year:parseInt(e)}}}return null}function getADDateRangeForBSMonth(_,e){if(!bsadMapping[_]||e<1||e>12)return{start:null,end:null};let t=getADDateFromBSData(_,e,1),a=e%12+1,n=e<12?_:_+1,l;return bsadMapping[n]&&bsadMapping[n][a-1]?(l=getADDateFromBSData(n,a,1)).setDate(l.getDate()-1):(l=new Date(t)).setDate(l.getDate()+29),{start:t,end:l}}function convertBStoAD(){let _=parseInt(document.getElementById("bs-year").value),e=parseInt(document.getElementById("bs-month").value),t=parseInt(document.getElementById("bs-day").value),a=getDaysInBSMonth(e,_);if(t<1||t>a){document.getElementById("bs-to-ad-result").innerText=`Invalid day. ${bsMonthNames[e-1]} ${_} has ${a} days.`,document.getElementById("bs-to-ad-result").style.display="block";return}let n=bsToAD(_,e,t);if(n){let l=n.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",weekday:"long"});document.getElementById("bs-to-ad-result").innerText=`BS ${t} ${bsMonthNames[e-1]} ${_} = ${l}`,document.getElementById("bs-to-ad-result").style.display="block"}else document.getElementById("bs-to-ad-result").innerText="Conversion failed. Please check your input.",document.getElementById("bs-to-ad-result").style.display="block"}function convertADtoBS(){let _=document.getElementById("ad-date").value;if(!_){document.getElementById("ad-to-bs-result").innerText="Please select a date.",document.getElementById("ad-to-bs-result").style.display="block";return}let e=new Date(_),t=adToBS(e);if(t){let a=`BS ${t.bs_day} ${bsMonthNames[t.bs_month-1]} ${t.bs_year}`;document.getElementById("ad-to-bs-result").innerText=`${e.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",weekday:"long"})} = ${a}`,document.getElementById("ad-to-bs-result").style.display="block"}else document.getElementById("ad-to-bs-result").innerText="Conversion failed. Date may be out of supported range.",document.getElementById("ad-to-bs-result").style.display="block"}function renderBSCalendar(){let _=new Date,e=adToBS(_);if(!e)return;let t=e.bs_year,a=e.bs_month;document.getElementById("calendar-title").innerText=`BS Calendar - ${bsMonthNames[a-1]} ${t}`;let n=getADDateRangeForBSMonth(t,a);if(!n.start||!n.end)return;let l=n.start,s=getDaysInBSMonth(a,t),d=l.getDay(),r="",o=1;for(let $=0;$<6&&!(o>s);$++){r+="<tr>";for(let i=0;i<7;i++)if(0===$&&i<d||o>s)r+='<td class="other-month"></td>';else{let y=o===e.bs_day,g=y?"current-day":"",u=bsToAD(t,a,o),b=u?u.getDate()+"/"+(u.getMonth()+1):"";r+=`<td class="${g}">
                    <div>${o}</div>
                    <div style="font-size: 0.8em; color: #666;">${b}</div>
                </td>`,o++}r+="</tr>"}document.getElementById("calendar-body").innerHTML=r}function updateCalendar(_,e){document.getElementById("calendar-title").innerText=`BS Calendar - ${bsMonthNames[e-1]} ${_}`;let t=getADDateRangeForBSMonth(_,e);if(!t.start||!t.end)return;let a=t.start,n=getDaysInBSMonth(e,_),l=a.getDay(),s="",d=1,r=new Date,o=adToBS(r),$=o&&o.bs_month===e&&o.bs_year===_;for(let i=0;i<6&&!(d>n);i++){s+="<tr>";for(let y=0;y<7;y++)if(0===i&&y<l||d>n)s+='<td class="other-month"></td>';else{let g=$&&d===o.bs_day,u=g?"current-day":"",b=bsToAD(_,e,d),m=b?b.getDate()+"/"+(b.getMonth()+1):"";s+=`<td class="${u}">
                    <div>${d}</div>
                    <div style="font-size: 0.8em; color: #666;">${m}</div>
                </td>`,d++}s+="</tr>"}document.getElementById("calendar-body").innerHTML=s}window.onload=function(){setDefaultDates(),updateTodayInfo(),renderBSCalendar()},document.getElementById("bs-month").addEventListener("change",function(){let _=parseInt(document.getElementById("bs-year").value),e=parseInt(this.value);updateCalendar(_,e)}),document.getElementById("bs-year").addEventListener("change",function(){let _=parseInt(this.value),e=parseInt(document.getElementById("bs-month").value);updateCalendar(_,e)});